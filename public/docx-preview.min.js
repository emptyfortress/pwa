!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.docx=t():e.docx=t()}(window,function(){return function(e){var t={};function r(a){if(t[a])return t[a].exports;var n=t[a]={i:a,l:!1,exports:{}};return e[a].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(e,t,a){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(a,n,function(t){return e[t]}.bind(null,n));return a},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=1)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Document=0]="Document",e[e.Paragraph=1]="Paragraph",e[e.Run=2]="Run",e[e.Break=3]="Break",e[e.Table=4]="Table",e[e.Row=5]="Row",e[e.Cell=6]="Cell",e[e.Hyperlink=7]="Hyperlink",e[e.Drawing=8]="Drawing",e[e.Image=9]="Image"}(t.DomType||(t.DomType={})),function(e){e[e.Settings=0]="Settings",e[e.Theme=1]="Theme",e[e.StylesWithEffects=2]="StylesWithEffects",e[e.Styles=3]="Styles",e[e.FontTable=4]="FontTable",e[e.Image=5]="Image",e[e.WebSettings=6]="WebSettings",e[e.Unknown=7]="Unknown"}(t.DomRelationshipType||(t.DomRelationshipType={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(2),n=r(3),s=r(4);t.renderAsync=function(e,t,r,o){void 0===r&&(r=null),void 0===o&&(o=null);var i=new n.DocumentParser,l=new s.HtmlRenderer(window.document);return o&&(i.ignoreWidth=o.ignoreWidth||i.ignoreWidth,i.ignoreHeight=o.ignoreHeight||i.ignoreHeight,i.debug=o.debug||i.debug,l.className=o.className||"docx",l.inWrapper=!o||null==o.inWrapper||o.inWrapper),a.Document.load(e,i).then(function(e){return l.render(e,t,r),e})}},function(e,t,r){"use strict";var a;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.Document="word/document.xml",e.Style="word/styles.xml",e.Numbering="word/numbering.xml",e.DocumentRelations="word/_rels/document.xml.rels",e.NumberingRelations="word/_rels/numbering.xml.rels",e.FontRelations="word/_rels/fontTable.xml.rels"}(a||(a={}));var n=function(){function e(){this.zip=new JSZip,this.docRelations=null,this.fontRelations=null,this.numRelations=null,this.styles=null,this.fonts=null,this.numbering=null,this.document=null}return e.load=function(t,r){var n=new e;return n.zip.loadAsync(t).then(function(e){var t=[n.loadPart(a.DocumentRelations,r),n.loadPart(a.FontRelations,r),n.loadPart(a.NumberingRelations,r),n.loadPart(a.Style,r),n.loadPart(a.Numbering,r),n.loadPart(a.Document,r)];return Promise.all(t.filter(function(e){return null!=e})).then(function(e){return n})})},e.prototype.loadDocumentImage=function(e){return this.loadResource(this.docRelations,e).then(function(e){return e?"data:image/png;base64,"+e:null})},e.prototype.loadNumberingImage=function(e){return this.loadResource(this.numRelations,e).then(function(e){return e?"data:image/png;base64,"+e:null})},e.prototype.loadFont=function(e){return this.loadResource(this.fontRelations,e).then(function(e){return e?"data:application/vnd.ms-package.obfuscated-opentype;charset=utf-8;base64,"+e:null})},e.prototype.loadResource=function(e,t){var r=e.filter(function(e){return e.id==t});return 0==r.length?Promise.resolve(null):this.zip.files["word/"+r[0].target].async("base64")},e.prototype.loadPart=function(e,t){var r=this,n=this.zip.files[e];return n?n.async("string").then(function(n){switch(e){case a.FontRelations:r.fontRelations=t.parseDocumentRelationsFile(n);break;case a.DocumentRelations:r.docRelations=t.parseDocumentRelationsFile(n);break;case a.NumberingRelations:r.numRelations=t.parseDocumentRelationsFile(n);break;case a.Style:r.styles=t.parseStylesFile(n);break;case a.Numbering:r.numbering=t.parseNumberingFile(n);break;case a.Document:r.document=t.parseDocumentFile(n)}return r}):null},e}();t.Document=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(0);t.autos={shd:"white",color:"black",highlight:"transparent"};var n,s=function(){function e(){this.skipDeclaration=!0,this.ignoreWidth=!1,this.ignoreHeight=!0,this.debug=!1}return e.prototype.parseDocumentRelationsFile=function(e){var t=o.parse(e,this.skipDeclaration);return o.elements(t).map(function(e){return{id:o.stringAttr(e,"Id"),type:i.valueOfRelType(e),target:o.stringAttr(e,"Target")}})},e.prototype.parseDocumentFile=function(e){var t=this,r={domType:a.DomType.Document,children:[],style:{}},n=o.byTagName(o.parse(e,this.skipDeclaration),"body");return o.foreach(n,function(e){switch(e.localName){case"p":r.children.push(t.parseParagraph(e));break;case"tbl":r.children.push(t.parseTable(e));break;case"sectPr":t.parseSectionProperties(e,r)}}),r},e.prototype.parseStylesFile=function(e){var t=this,r=[],a=o.parse(e,this.skipDeclaration);return o.foreach(a,function(e){switch(e.localName){case"style":r.push(t.parseStyle(e));break;case"docDefaults":r.push(t.parseDefaultStyles(e))}}),r},e.prototype.parseDefaultStyles=function(e){var t=this,r={id:null,name:null,target:null,basedOn:null,styles:[]};return o.foreach(e,function(e){switch(e.localName){case"rPrDefault":var a=o.byTagName(e,"rPr");a&&r.styles.push({target:"span",values:t.parseDefaultProperties(a,{})});break;case"pPrDefault":var n=o.byTagName(e,"pPr");n&&r.styles.push({target:"p",values:t.parseDefaultProperties(n,{})})}}),r},e.prototype.parseStyle=function(e){var t=this,r={id:o.className(e,"styleId"),isDefault:o.boolAttr(e,"default"),name:null,target:null,basedOn:null,styles:[]};switch(o.stringAttr(e,"type")){case"paragraph":r.target="p";break;case"table":r.target="table";break;case"character":r.target="span"}return o.foreach(e,function(e){switch(e.localName){case"basedOn":r.basedOn=o.stringAttr(e,"val");break;case"name":r.name=o.stringAttr(e,"val");break;case"pPr":r.styles.push({target:"p",values:t.parseDefaultProperties(e,{})});break;case"rPr":r.styles.push({target:"span",values:t.parseDefaultProperties(e,{})});break;case"tblPr":case"tcPr":r.styles.push({target:"td",values:t.parseDefaultProperties(e,{})});break;case"tblStylePr":for(var a=0,n=t.parseTableStyle(e);a<n.length;a++){var s=n[a];r.styles.push(s)}break;case"rsid":case"qFormat":case"hidden":case"semiHidden":case"unhideWhenUsed":case"autoRedefine":case"uiPriority":break;default:t.debug&&console.warn("DOCX: Unknown style element: "+e.localName)}}),r},e.prototype.parseTableStyle=function(e){var t=this,r=[],a=o.stringAttr(e,"type"),n="";switch(a){case"firstRow":n="tr.first-row";break;case"lastRow":n="tr.last-row";break;case"firstCol":n="td.first-col";break;case"lastCol":n="td.last-col";break;case"band1Vert":n="td.odd-col";break;case"band2Vert":n="td.even-col";break;case"band1Horz":n="tr.odd-row";break;case"band2Horz":n="tr.even-row";break;default:return[]}return o.foreach(e,function(e){switch(e.localName){case"pPr":r.push({target:n+" p",values:t.parseDefaultProperties(e,{})});break;case"rPr":r.push({target:n+" span",values:t.parseDefaultProperties(e,{})});break;case"tblPr":case"tcPr":r.push({target:n,values:t.parseDefaultProperties(e,{})})}}),r},e.prototype.parseNumberingFile=function(e){var t=this,r=[],a=o.parse(e,this.skipDeclaration),n={},s=[];return o.foreach(a,function(e){switch(e.localName){case"abstractNum":t.parseAbstractNumbering(e,s).forEach(function(e){return r.push(e)});break;case"numPicBullet":s.push(t.parseNumberingPicBullet(e));break;case"num":var a=o.stringAttr(e,"numId"),i=o.elementStringAttr(e,"abstractNumId","val");n[i]=a}}),r.forEach(function(e){return e.id=n[e.id]}),r},e.prototype.parseNumberingPicBullet=function(e){var t=o.byTagName(e,"pict"),r=t&&o.byTagName(t,"shape"),a=r&&o.byTagName(r,"imagedata");return a?{id:o.intAttr(e,"numPicBulletId"),src:o.stringAttr(a,"id"),style:o.stringAttr(r,"style")}:null},e.prototype.parseAbstractNumbering=function(e,t){var r=this,a=[],n=o.stringAttr(e,"abstractNumId");return o.foreach(e,function(e){switch(e.localName){case"lvl":a.push(r.parseNumberingLevel(n,e,t))}}),a},e.prototype.parseNumberingLevel=function(e,t,r){var a=this,n={id:e,level:o.intAttr(t,"ilvl"),style:{}};return o.foreach(t,function(e){switch(e.localName){case"pPr":a.parseDefaultProperties(e,n.style);break;case"lvlPicBulletId":var t=o.intAttr(e,"val");n.bullet=r.filter(function(e){return e.id==t})[0];break;case"lvlText":n.levelText=o.stringAttr(e,"val");break;case"numFmt":n.format=o.stringAttr(e,"val")}}),n},e.prototype.parseSectionProperties=function(e,t){var r=this;o.foreach(e,function(e){switch(e.localName){case"pgMar":t.style["padding-left"]=o.sizeAttr(e,"left"),t.style["padding-right"]=o.sizeAttr(e,"right"),t.style["padding-top"]=o.sizeAttr(e,"top"),t.style["padding-bottom"]=o.sizeAttr(e,"bottom");break;case"pgSz":r.ignoreWidth||(t.style.width=o.sizeAttr(e,"w")),r.ignoreHeight||(t.style.height=o.sizeAttr(e,"h"))}})},e.prototype.parseParagraph=function(e){var t=this,r={domType:a.DomType.Paragraph,children:[]};return o.foreach(e,function(e){switch(e.localName){case"r":r.children.push(t.parseRun(e,r));break;case"hyperlink":r.children.push(t.parseHyperlink(e,r));break;case"bookmarkStart":r.children.push(t.parseBookmark(e));break;case"pPr":t.parseParagraphProperties(e,r)}}),r},e.prototype.parseParagraphProperties=function(e,t){var r=this;this.parseDefaultProperties(e,t.style={},null,function(e){switch(e.localName){case"pStyle":t.className=o.className(e,"val");break;case"numPr":r.parseNumbering(e,t);break;case"framePr":r.parseFrame(e,t);break;case"tabs":r.parseTabs(e,t);break;case"rPr":break;default:return!1}return!0})},e.prototype.parseNumbering=function(e,t){o.foreach(e,function(e){switch(e.localName){case"numId":t.numberingId=o.stringAttr(e,"val");break;case"ilvl":t.numberingLevel=o.intAttr(e,"val")}})},e.prototype.parseFrame=function(e,t){"drop"==o.stringAttr(e,"dropCap")&&(t.style.float="left")},e.prototype.parseBookmark=function(e){var t={domType:a.DomType.Run};return t.id=o.stringAttr(e,"name"),t},e.prototype.parseHyperlink=function(e,t){var r=this,n={domType:a.DomType.Hyperlink,parent:t,children:[]},s=o.stringAttr(e,"anchor");return s&&(n.href="#"+s),o.foreach(e,function(e){switch(e.localName){case"r":n.children.push(r.parseRun(e,n))}}),n},e.prototype.parseRun=function(e,t){var r=this,n={domType:a.DomType.Run,parent:t};return o.foreach(e,function(e){switch(e.localName){case"t":n.text=e.textContent;break;case"br":n.break=o.stringAttr(e,"type")||"textWrapping";break;case"tab":n.tab=!0;break;case"drawing":var t=r.parseDrawing(e);t&&(n.children=[t]);break;case"rPr":r.parseRunProperties(e,n)}}),n},e.prototype.parseRunProperties=function(e,t){this.parseDefaultProperties(e,t.style={},null,function(e){switch(e.localName){case"rStyle":t.className=o.className(e,"val");break;case"vertAlign":switch(o.stringAttr(e,"val")){case"subscript":t.wrapper="sub";break;case"superscript":t.wrapper="sup"}break;default:return!1}return!0})},e.prototype.parseDrawing=function(e){for(var t=0,r=o.elements(e);t<r.length;t++){var a=r[t];switch(a.localName){case"inline":case"anchor":return this.parseDrawingWrapper(a)}}},e.prototype.parseDrawingWrapper=function(e){for(var t={domType:a.DomType.Drawing,children:[],style:{}},r="anchor"==e.localName,s=!1,i=o.boolAttr(e,"simplePos"),l={relative:"page",align:"left",offset:"0"},c={relative:"page",align:"top",offset:"0"},u=0,p=o.elements(e);u<p.length;u++){var h=p[u];switch(h.localName){case"simplePos":i&&(l.offset=o.sizeAttr(h,"x",n.Emu),c.offset=o.sizeAttr(h,"y",n.Emu));break;case"extent":t.style.width=o.sizeAttr(h,"cx",n.Emu),t.style.height=o.sizeAttr(h,"cy",n.Emu);break;case"positionH":case"positionV":if(!i){var d="positionH"==h.localName?l:c,m=o.byTagName(h,"align"),f=o.byTagName(h,"posOffset");m&&(d.align=m.textContent),f&&(d.offset=o.sizeValue(e,n.Emu))}break;case"wrapTopAndBottom":s=!0;break;case"graphic":var y=this.parseGraphic(h);y&&t.children.push(y)}}return s?(t.style.display="block",l.align&&(t.style["text-align"]=l.align,t.style.width="100%")):!r||"left"!=l.align&&"right"!=l.align||(t.style.float=l.align),t},e.prototype.parseGraphic=function(e){for(var t=o.byTagName(e,"graphicData"),r=0,a=o.elements(t);r<a.length;r++){var n=a[r];switch(n.localName){case"pic":return this.parsePicture(n)}}return null},e.prototype.parsePicture=function(e){var t={domType:a.DomType.Image,src:"",style:{}},r=o.byTagName(e,"blipFill"),s=o.byTagName(r,"blip");t.src=o.stringAttr(s,"embed");var i=o.byTagName(e,"spPr"),l=o.byTagName(i,"xfrm");t.style.position="relative";for(var c=0,u=o.elements(l);c<u.length;c++){var p=u[c];switch(p.localName){case"ext":t.style.width=o.sizeAttr(p,"cx",n.Emu),t.style.height=o.sizeAttr(p,"cy",n.Emu);break;case"off":t.style.left=o.sizeAttr(p,"x",n.Emu),t.style.top=o.sizeAttr(p,"y",n.Emu)}}return t},e.prototype.parseTable=function(e){var t=this,r={domType:a.DomType.Table,children:[]};return o.foreach(e,function(e){switch(e.localName){case"tr":r.children.push(t.parseTableRow(e));break;case"tblGrid":r.columns=t.parseTableColumns(e);break;case"tblPr":t.parseTableProperties(e,r)}}),r},e.prototype.parseTableColumns=function(e){var t=[];return o.foreach(e,function(e){switch(e.localName){case"gridCol":t.push({width:o.sizeAttr(e,"w")})}}),t},e.prototype.parseTableProperties=function(e,t){var r=this;switch(t.style={},t.cellStyle={},this.parseDefaultProperties(e,t.style,t.cellStyle,function(e){switch(e.localName){case"tblStyle":t.className=o.className(e,"val");break;case"tblpPr":r.parseTablePosition(e,t);break;default:return!1}return!0}),t.style["text-align"]){case"center":delete t.style["text-align"],t.style["margin-left"]="auto",t.style["margin-right"]="auto";break;case"right":delete t.style["text-align"],t.style["margin-left"]="auto"}},e.prototype.parseTablePosition=function(e,t){o.stringAttr(e,"vertAnchor"),o.stringAttr(e,"horzAnchor"),o.sizeAttr(e,"tblpX"),o.sizeAttr(e,"tblpY"),o.stringAttr(e,"tblpXSpec"),o.stringAttr(e,"tblpYSpec");var r=o.sizeAttr(e,"topFromText"),a=o.sizeAttr(e,"bottomFromText"),n=o.sizeAttr(e,"rightFromText"),s=o.sizeAttr(e,"leftFromText");t.style.float="left",t.style["margin-bottom"]=i.addSize(t.style["margin-bottom"],a),t.style["margin-left"]=i.addSize(t.style["margin-left"],s),t.style["margin-right"]=i.addSize(t.style["margin-right"],n),t.style["margin-top"]=i.addSize(t.style["margin-top"],r)},e.prototype.parseTableRow=function(e){var t=this,r={domType:a.DomType.Row,children:[]};return o.foreach(e,function(e){switch(e.localName){case"tc":r.children.push(t.parseTableCell(e));break;case"trPr":t.parseTableRowProperties(e,r)}}),r},e.prototype.parseTableRowProperties=function(e,t){t.style=this.parseDefaultProperties(e,{},null,function(e){switch(e.localName){case"cnfStyle":t.className=i.classNameOfCnfStyle(e);break;default:return!1}return!0})},e.prototype.parseTableCell=function(e){var t=this,r={domType:a.DomType.Cell,children:[]};return o.foreach(e,function(e){switch(e.localName){case"tbl":r.children.push(t.parseTable(e));break;case"p":r.children.push(t.parseParagraph(e));break;case"tcPr":t.parseTableCellProperties(e,r)}}),r},e.prototype.parseTableCellProperties=function(e,t){t.style=this.parseDefaultProperties(e,{},null,function(e){switch(e.localName){case"gridSpan":t.span=o.intAttr(e,"val",null);break;case"vMerge":break;case"cnfStyle":t.className=i.classNameOfCnfStyle(e);break;default:return!1}return!0})},e.prototype.parseDefaultProperties=function(e,r,a,s){var l=this;return void 0===r&&(r=null),void 0===a&&(a=null),void 0===s&&(s=null),r=r||{},o.foreach(e,function(e){switch(e.localName){case"jc":r["text-align"]=i.valueOfJc(e);break;case"textAlignment":r["vertical-align"]=i.valueOfTextAlignment(e);break;case"color":r.color=o.colorAttr(e,"val",null,t.autos.color);break;case"sz":r["font-size"]=o.sizeAttr(e,"val",n.FontSize);break;case"shd":r["background-color"]=o.colorAttr(e,"fill",null,t.autos.shd);break;case"highlight":r["background-color"]=o.colorAttr(e,"val",null,t.autos.highlight);break;case"tcW":if(l.ignoreWidth)break;case"tblW":r.width=i.valueOfSize(e,"w");break;case"trHeight":l.parseTrHeight(e,r);break;case"strike":r["text-decoration"]=i.valueOfStrike(e);break;case"b":r["font-weight"]=i.valueOfBold(e);break;case"i":r["font-style"]="italic";break;case"u":l.parseUnderline(e,r);break;case"ind":l.parseIndentation(e,r);break;case"rFonts":l.parseFont(e,r);break;case"tblBorders":l.parseBorderProperties(e,a||r);break;case"tblCellSpacing":r["border-spacing"]=i.valueOfMargin(e),r["border-collapse"]="separate";break;case"pBdr":case"tcBorders":l.parseBorderProperties(e,r);break;case"noWrap":break;case"tblCellMar":case"tcMar":l.parseMarginProperties(e,a||r);break;case"tblLayout":r["table-layout"]=i.valueOfTblLayout(e);break;case"vAlign":r["vertical-align"]=o.stringAttr(e,"val");break;case"spacing":l.parseSpacing(e,r);break;case"lang":case"noProof":case"webHidden":break;default:null==s||s(e)||l.debug&&console.warn("DOCX: Unknown document element: "+e.localName)}}),r},e.prototype.parseUnderline=function(e,t){var r=o.stringAttr(e,"val");if(null!=r&&"none"!=r){switch(r){case"dash":case"dashDotDotHeavy":case"dashDotHeavy":case"dashedHeavy":case"dashLong":case"dashLongHeavy":case"dotDash":case"dotDotDash":t["text-decoration-style"]="dashed";break;case"dotted":case"dottedHeavy":t["text-decoration-style"]="dotted";break;case"double":t["text-decoration-style"]="double";break;case"single":case"thick":t["text-decoration"]="underline";break;case"wave":case"wavyDouble":case"wavyHeavy":t["text-decoration-style"]="wavy";break;case"words":t["text-decoration"]="underline"}var a=o.colorAttr(e,"color");a&&(t["text-decoration-color"]=a)}},e.prototype.parseFont=function(e,t){var r=o.stringAttr(e,"ascii");r&&(t["font-family"]=r)},e.prototype.parseIndentation=function(e,t){var r=o.sizeAttr(e,"firstLine"),a=o.sizeAttr(e,"left"),n=o.sizeAttr(e,"start"),s=o.sizeAttr(e,"right"),i=o.sizeAttr(e,"end");r&&(t["text-indent"]=r),(a||n)&&(t["margin-left"]=a||n),(s||i)&&(t["margin-right"]=s||i)},e.prototype.parseSpacing=function(e,t){var r=o.sizeAttr(e,"before"),a=o.sizeAttr(e,"after"),n=o.sizeAttr(e,"line");r&&(t["margin-top"]=r),a&&(t["margin-bottom"]=a),n&&(t["line-height"]=n,t["min-height"]=n)},e.prototype.parseTabs=function(e,t){t.tabs=o.elements(e,"tab").map(function(e){return{position:o.sizeAttr(e,"pos"),leader:o.stringAttr(e,"leader"),style:o.stringAttr(e,"val")}})},e.prototype.parseMarginProperties=function(e,t){o.foreach(e,function(e){switch(e.localName){case"left":t["padding-left"]=i.valueOfMargin(e);break;case"right":t["padding-right"]=i.valueOfMargin(e);break;case"top":t["padding-top"]=i.valueOfMargin(e);break;case"bottom":t["padding-bottom"]=i.valueOfMargin(e)}})},e.prototype.parseTrHeight=function(e,t){switch(o.stringAttr(e,"hRule")){case"exact":t.height=o.sizeAttr(e,"val");break;case"atLeast":default:t.height=o.sizeAttr(e,"val")}},e.prototype.parseBorderProperties=function(e,t){o.foreach(e,function(e){switch(e.localName){case"start":case"left":t["border-left"]=i.valueOfBorder(e);break;case"end":case"right":t["border-right"]=i.valueOfBorder(e);break;case"top":t["border-top"]=i.valueOfBorder(e);break;case"bottom":t["border-bottom"]=i.valueOfBorder(e)}})},e}();t.DocumentParser=s,function(e){e[e.FontSize=0]="FontSize",e[e.Dxa=1]="Dxa",e[e.Emu=2]="Emu",e[e.Border=3]="Border",e[e.Percent=4]="Percent"}(n||(n={}));var o=function(){function e(){}return e.parse=function(e,t){return void 0===t&&(t=!0),t&&(e=e.replace(/<[?].*[?]>/,"")),(new DOMParser).parseFromString(e,"application/xml").firstChild},e.elements=function(e,t){void 0===t&&(t=null);for(var r=[],a=0;a<e.childNodes.length;a++){var n=e.childNodes[a];1!=n.nodeType||null!=t&&n.localName!=t||r.push(n)}return r},e.foreach=function(e,t){for(var r=0;r<e.childNodes.length;r++){var a=e.childNodes[r];1==a.nodeType&&t(a)}},e.byTagName=function(e,t){for(var r=0;r<e.childNodes.length;r++){var a=e.childNodes[r];if(1==a.nodeType&&a.localName==t)return e.childNodes[r]}return null},e.elementStringAttr=function(t,r,a){var n=e.byTagName(t,r);return n?e.stringAttr(n,a):null},e.stringAttr=function(e,t){for(var r=e,a=0;a<r.attributes.length;a++){var n=r.attributes.item(a);if(n.localName==t)return n.value}return null},e.colorAttr=function(t,r,a,n){void 0===a&&(a=null),void 0===n&&(n="black");var s=e.stringAttr(t,r);switch(s){case"yellow":return s;case"auto":return n}return s?"#"+s:a},e.boolAttr=function(t,r,a){switch(void 0===a&&(a=!1),e.stringAttr(t,r)){case"1":return!0;case"0":return!1}return a},e.intAttr=function(t,r,a){return void 0===a&&(a=0),e.stringAttr(t,r)?parseInt(e.stringAttr(t,r)):0},e.sizeAttr=function(t,r,a){return void 0===a&&(a=n.Dxa),e.convertSize(e.stringAttr(t,r),a)},e.sizeValue=function(t,r){return void 0===r&&(r=n.Dxa),e.convertSize(t.textContent,r)},e.convertSize=function(e,t){if(void 0===t&&(t=n.Dxa),null==e||e.indexOf("pt")>-1)return e;var r=parseInt(e);switch(t){case n.Dxa:return(.05*r).toFixed(2)+"pt";case n.Emu:return(r/12700).toFixed(2)+"pt";case n.FontSize:return(.5*r).toFixed(2)+"pt";case n.Border:return(.125*r).toFixed(2)+"pt";case n.Percent:return(.02*r).toFixed(2)+"%"}return e},e.className=function(t,r){var a=e.stringAttr(t,r);return a&&a.replace(/[ .]+/g,"-").replace(/[&]+/g,"and")},e}(),i=function(){function e(){}return e.valueOfBold=function(e){return o.boolAttr(e,"val",!0)?"bold":"normal"},e.valueOfSize=function(e,t){var r=n.Dxa;switch(o.stringAttr(e,"type")){case"dxa":break;case"pct":r=n.Percent}return o.sizeAttr(e,t,r)},e.valueOfStrike=function(e){return o.boolAttr(e,"val",!0)?"line-through":"none"},e.valueOfMargin=function(e){return o.sizeAttr(e,"w")},e.valueOfRelType=function(e){switch(o.sizeAttr(e,"Type")){case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/settings":return a.DomRelationshipType.Settings;case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme":return a.DomRelationshipType.Theme;case"http://schemas.microsoft.com/office/2007/relationships/stylesWithEffects":return a.DomRelationshipType.StylesWithEffects;case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles":return a.DomRelationshipType.Styles;case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/fontTable":return a.DomRelationshipType.FontTable;case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image":return a.DomRelationshipType.Image;case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/webSettings":return a.DomRelationshipType.WebSettings}return a.DomRelationshipType.Unknown},e.valueOfBorder=function(e){if("nil"==o.stringAttr(e,"val"))return"none";var t=o.colorAttr(e,"color");return o.sizeAttr(e,"sz",n.Border)+" solid "+("auto"==t?"black":t)},e.valueOfTblLayout=function(e){return"fixed"==o.stringAttr(e,"val")?"fixed":"auto"},e.classNameOfCnfStyle=function(e){var t="",r=o.stringAttr(e,"val");return"1"==r[0]&&(t+=" first-row"),"1"==r[1]&&(t+=" last-row"),"1"==r[2]&&(t+=" first-col"),"1"==r[3]&&(t+=" last-col"),"1"==r[4]&&(t+=" odd-col"),"1"==r[5]&&(t+=" even-col"),"1"==r[6]&&(t+=" odd-row"),"1"==r[7]&&(t+=" even-row"),"1"==r[8]&&(t+=" ne-cell"),"1"==r[9]&&(t+=" nw-cell"),"1"==r[10]&&(t+=" se-cell"),"1"==r[11]&&(t+=" sw-cell"),t.trim()},e.valueOfJc=function(e){var t=o.stringAttr(e,"val");switch(t){case"start":case"left":return"left";case"center":return"center";case"end":case"right":return"right";case"both":return"justify"}return t},e.valueOfTextAlignment=function(e){var t=o.stringAttr(e,"val");switch(t){case"auto":case"baseline":return"baseline";case"top":return"top";case"center":return"middle";case"bottom":return"bottom"}return t},e.addSize=function(e,t){return null==e?t:null==t?e:"calc("+e+" + "+t+")"},e.checkMask=function(e,t){return(e&t)==t},e.classNameOftblLook=function(t){var r=o.stringAttr(t,"val"),a=parseInt(r,16),n="";return e.checkMask(a,32)&&(n+=" first-row"),e.checkMask(a,64)&&(n+=" last-row"),e.checkMask(a,128)&&(n+=" first-col"),e.checkMask(a,256)&&(n+=" last-col"),e.checkMask(a,512)||(n+=" odd-row even-row"),e.checkMask(a,1024)||(n+=" odd-col even-col"),n.trim()},e}()},function(e,t,r){"use strict";var a=this&&this.__assign||function(){return(a=Object.assign||function(e){for(var t,r=1,a=arguments.length;r<a;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),s=function(){function e(e){this.htmlDocument=e,this.inWrapper=!0,this.className="docx",this.digitTest=/^[0-9]/.test}return e.prototype.render=function(e,t,r){void 0===r&&(r=null),this.document=e,r=r||t,this.clearElement(r),this.clearElement(t),r.appendChild(this.htmlDocument.createComment("docxjs library predefined styles")),r.appendChild(this.renderDefaultStyle()),r.appendChild(this.htmlDocument.createComment("docx document styles")),r.appendChild(this.renderStyles(e.styles)),e.numbering&&(r.appendChild(this.htmlDocument.createComment("docx document numbering styles")),r.appendChild(this.renderNumbering(e.numbering,r)));var a=this.renderDocument(e.document);if(this.inWrapper){var n=this.renderWrapper();n.appendChild(a),t.appendChild(n)}else t.appendChild(a)},e.prototype.clearElement=function(e){for(;e.firstChild;)e.removeChild(e.firstChild)},e.prototype.processClassName=function(e){return e?this.className+"_"+e:this.className},e.prototype.processStyles=function(e){for(var t={},r=0,a=e;r<a.length;r++){(o=a[r]).id=this.processClassName(o.id),o.basedOn=this.processClassName(o.basedOn),t[o.id]=o}for(var n=0,s=e;n<s.length;n++){var o;if((o=s[n]).basedOn)for(var i,l=t[o.basedOn],c=function(e){(i=l.styles.filter(function(t){return t.target==e.target}))&&i.length>0&&u.copyStyleProperties(i[0].values,e.values)},u=this,p=0,h=o.styles;p<h.length;p++){c(h[p])}}},e.prototype.processElement=function(e){if(e.children)for(var t=0,r=e.children;t<r.length;t++){var a=r[t];a.className=this.processClassName(a.className),a.domType==n.DomType.Table?this.processTable(a):this.processElement(a)}},e.prototype.processTable=function(e){for(var t=0,r=e.children;t<r.length;t++)for(var a=0,n=r[t].children;a<n.length;a++){var s=n[a];s.style=this.copyStyleProperties(e.cellStyle,s.style,["border-left","border-right","border-top","border-bottom","padding-left","padding-right","padding-top","padding-bottom"]),this.processElement(s)}},e.prototype.copyStyleProperties=function(e,t,r){if(void 0===r&&(r=null),!e)return t;null==t&&(t={}),null==r&&(r=Object.getOwnPropertyNames(e));for(var a=0,n=r;a<n.length;a++){var s=n[a];e.hasOwnProperty(s)&&!t.hasOwnProperty(s)&&(t[s]=e[s])}return t},e.prototype.renderDocument=function(e){var t=this.htmlDocument.createElement("section");return t.className=this.className,this.processElement(e),this.renderChildren(e,t),this.renderStyleValues(e.style,t),t},e.prototype.renderWrapper=function(){var e=document.createElement("div");return e.className=this.className+"-wrapper",e},e.prototype.renderDefaultStyle=function(){var e="."+this.className+"-wrapper { background: gray; padding: 30px; display: flex; justify-content: center; } \n                ."+this.className+"-wrapper section."+this.className+" { background: white; box-shadow: 0 0 10px rgba(0, 0, 0, 0.5); }\n                ."+this.className+" { color: black; }\n                section."+this.className+" { box-sizing: border-box; }\n                ."+this.className+" table { border-collapse: collapse; }\n                ."+this.className+" table td, ."+this.className+" table th { vertical-align: top; }\n                ."+this.className+" p { margin: 0pt; }";return this.renderStyle(e)},e.prototype.renderNumbering=function(e,t){for(var r,n,s=this,o="",i=[],l=function(){if(r="p."+c.numberingClass(h.id,h.level),n="none",h.levelText&&"decimal"==h.format){var e=c.numberingCounter(h.id,h.level);h.level>0?o+=c.styleToString("p."+c.numberingClass(h.id,h.level-1),{"counter-reset":e}):i.push(e),o+=c.styleToString(r+":before",{content:c.levelTextToContent(h.levelText,h.id),"counter-increment":e}),o+=c.styleToString(r,a({display:"list-item","list-style-position":"inside","list-style-type":"none"},h.style))}else if(h.bullet){var l=("--"+c.className+"-"+h.bullet.src).toLowerCase();o+=c.styleToString(r+":before",{content:"' '",display:"inline-block",background:"var("+l+")"},h.bullet.style),c.document.loadNumberingImage(h.bullet.src).then(function(e){var r="."+s.className+"-wrapper { "+l+": url("+e+") }";t.appendChild(s.renderStyle(r))})}else n=c.numFormatToCssValue(h.format);o+=c.styleToString(r,a({display:"list-item","list-style-position":"inside","list-style-type":n},h.style))},c=this,u=0,p=e;u<p.length;u++){var h=p[u];l()}return i.length>0&&(o+=this.styleToString("."+this.className+"-wrapper",{"counter-reset":i.join(" ")})),this.renderStyle(o)},e.prototype.renderStyle=function(e){var t=document.createElement("style");return t.type="text/css",t.innerHTML=e,t},e.prototype.renderStyles=function(e){var t="";this.processStyles(e);for(var r=0,a=e;r<a.length;r++)for(var n=a[r],s=0,o=n.styles;s<o.length;s++){var i=o[s],l="";n.target==i.target?l+=n.target+"."+n.id:n.target?l+=n.target+"."+n.id+" "+i.target:l+="."+n.id+" "+i.target,n.isDefault&&n.target&&(l="."+this.className+" "+n.target+", "+l),t+=this.styleToString(l,i.values)}return this.renderStyle(t)},e.prototype.renderElement=function(e,t){switch(e.domType){case n.DomType.Paragraph:return this.renderParagraph(e);case n.DomType.Run:return this.renderRun(e);case n.DomType.Table:return this.renderTable(e);case n.DomType.Row:return this.renderTableRow(e);case n.DomType.Cell:return this.renderTableCell(e);case n.DomType.Hyperlink:return this.renderHyperlink(e);case n.DomType.Drawing:return this.renderDrawing(e);case n.DomType.Image:return this.renderImage(e)}return null},e.prototype.renderChildren=function(e,t){var r=this,a=null;return null!=e.children&&(a=e.children.map(function(t){return r.renderElement(t,e)}).filter(function(e){return null!=e})),t&&a&&a.forEach(function(e){return t.appendChild(e)}),a},e.prototype.renderParagraph=function(e){var t=this.htmlDocument.createElement("p");return this.renderClass(e,t),this.renderChildren(e,t),this.renderStyleValues(e.style,t),e.numberingId&&null!=e.numberingLevel&&(t.className=t.className+" "+this.numberingClass(e.numberingId,e.numberingLevel)),t},e.prototype.renderHyperlink=function(e){var t=this.htmlDocument.createElement("a");return this.renderChildren(e,t),this.renderStyleValues(e.style,t),e.href&&(t.href=e.href),t},e.prototype.renderDrawing=function(e){var t=this.htmlDocument.createElement("div");return t.style.display="inline-block",t.style.position="relative",t.style.textIndent="0px",this.renderChildren(e,t),this.renderStyleValues(e.style,t),t},e.prototype.renderImage=function(e){var t=this.htmlDocument.createElement("img");return this.renderStyleValues(e.style,t),this.document&&this.document.loadDocumentImage(e.src).then(function(e){t.src=e}),t},e.prototype.renderRun=function(e){if(e.break)return this.htmlDocument.createElement("page"==e.break?"hr":"br");var t=this.htmlDocument.createElement("span");if(e.text&&(t.textContent=e.text),this.renderClass(e,t),this.renderChildren(e,t),this.renderStyleValues(e.style,t),e.id&&(t.id=e.id),e.tab);else{if(e.href){var r=this.htmlDocument.createElement("a");return r.href=e.href,r.appendChild(t),r}if(e.wrapper){var a=this.htmlDocument.createElement(e.wrapper);return a.appendChild(t),a}}return t},e.prototype.renderTable=function(e){var t=this.htmlDocument.createElement("table");return this.renderClass(e,t),this.renderChildren(e,t),this.renderStyleValues(e.style,t),e.columns&&t.appendChild(this.renderTableColumns(e.columns)),t},e.prototype.renderTableColumns=function(e){for(var t=this.htmlDocument.createElement("colGroup"),r=0,a=e;r<a.length;r++){var n=a[r],s=this.htmlDocument.createElement("col");n.width&&(s.style.width=n.width+"px"),t.appendChild(s)}return t},e.prototype.renderTableRow=function(e){var t=this.htmlDocument.createElement("tr");return this.renderClass(e,t),this.renderChildren(e,t),this.renderStyleValues(e.style,t),t},e.prototype.renderTableCell=function(e){var t=this.htmlDocument.createElement("td");return this.renderClass(e,t),this.renderChildren(e,t),this.renderStyleValues(e.style,t),e.span&&(t.colSpan=e.span),t},e.prototype.renderStyleValues=function(e,t){if(null!=e)for(var r in e)e.hasOwnProperty(r)&&(t.style[r]=e[r])},e.prototype.renderClass=function(e,t){e.className&&(t.className=e.className)},e.prototype.numberingClass=function(e,t){return this.className+"-num-"+e+"-"+t},e.prototype.styleToString=function(e,t,r){void 0===r&&(r=null);var a=e+" {\r\n";for(var n in t)a+="  "+n+": "+t[n]+";\r\n";return r&&(a+=";"+r),a+"}\r\n"},e.prototype.numberingCounter=function(e,t){return this.className+"-num-"+e+"-"+t},e.prototype.levelTextToContent=function(e,t){var r=this;return'"'+e.replace(/%\d*/g,function(e){var a=parseInt(e.substring(1),10)-1;return'"counter('+r.numberingCounter(t,a)+')"'})+'"'},e.prototype.numFormatToCssValue=function(e){return{none:"none",bullet:"disc",decimal:"decimal",lowerLetter:"lower-alpha",upperLetter:"upper-alpha",lowerRoman:"lower-roman",upperRoman:"upper-roman"}[e]||e},e}();t.HtmlRenderer=s}])});
//# sourceMappingURL=docx-preview.min.js.map